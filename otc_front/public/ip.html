
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP地址提交表单</title>
    <link href="./static/tailwind.min.css" rel="stylesheet">
    <link href="./static/all.min.css" rel="stylesheet">
    <style>
        .form-container {
            transition: all 0.3s ease;
        }
        .form-container:hover {
            transform: translateY(-5px);
        }
        .ip-input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        .submit-btn {
            transition: all 0.3s ease;
        }
        .submit-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }
        .result-box {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div id="app" class="container mx-auto px-4 py-12">
        <div class="max-w-2xl mx-auto">
            <!-- 头部 -->
            <div class="text-center mb-10">
                <h1 class="text-3xl font-bold text-gray-800 mb-3">
                    <i class="fas fa-network-wired text-blue-500 mr-3"></i>IP地址提交表单
                </h1>
                <p class="text-gray-600">请输入有效的IPv4或IPv6地址进行提交</p>
            </div>

            <!-- 表单卡片 -->
            <div class="form-container bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="p-1 bg-gradient-to-r from-blue-500 to-purple-600"></div>
                <div class="p-8">
                    <!-- IP输入表单 -->
                    <form @submit.prevent="submitIp" class="space-y-6">
                        <div>
                            <label for="ipAddress" class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-globe mr-2"></i>IP地址
                            </label>
                            <input 
                                id="ipAddress"
                                v-model="formData.ip"
                                type="text"
                                placeholder="例如: 192.168.1.1 或 2001:0db8:85a3:0000:0000:8a2e:0370:7334"
                                class="ip-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"
                                required
                            >
                            <p class="mt-2 text-sm text-gray-500">
                                支持IPv4和IPv6地址格式
                            </p>
                        </div>

                        <!-- 提交按钮 -->
                        <div class="flex justify-center">
                            <button 
                                type="submit"
                                :disabled="isSubmitting"
                                class="submit-btn flex items-center justify-center px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-medium rounded-full hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md"
                            >
                                <i :class="isSubmitting ? 'fas fa-spinner fa-spin mr-2' : 'fas fa-paper-plane mr-2'"></i>
                                {{ isSubmitting ? '提交中...' : '提交IP地址' }}
                            </button>
                        </div>
                    </form>

                    <!-- 提交结果 -->
                    <div v-if="submitResult.message" class="mt-8">
                        <div 
                            :class="[
                                'result-box p-4 rounded-lg border',
                                submitResult.type === 'success' ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'
                            ]"
                        >
                            <div class="flex items-center">
                                <i 
                                    :class="[
                                        'text-xl mr-3',
                                        submitResult.type === 'success' ? 'text-green-500 fas fa-check-circle' : 'text-red-500 fas fa-exclamation-circle'
                                    ]"
                                ></i>
                                <span :class="submitResult.type === 'success' ? 'text-green-700' : 'text-red-700'">
                                    {{ submitResult.message }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- API配置 -->
                    <div class="mt-8 pt-6 border-t border-gray-200" v-if="false">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-cog text-gray-500 mr-2"></i>API配置
                        </h3>
                        <div class="grid grid-cols-1 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">提交地址</label>
                                <input 
                                    v-model="apiConfig.url" 
                                    type="url" 
                                    placeholder="请输入API提交地址"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">认证Token (可选)</label>
                                <input 
                                    v-model="apiConfig.token" 
                                    type="text" 
                                    placeholder="请输入Bearer Token"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 说明信息 -->
            <div class="mt-8 text-center text-gray-600 text-sm">
                <p>© 2023 IP地址提交表单 - 基于Vue.js和Axios构建</p>
            </div>
        </div>
    </div>

    <!-- Vue.js and Axios CDNs -->
    <script src="./static/vue.js"></script>
    <script src="./static/axios.min.js"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    formData: {
                        ip: ''
                    },
                    isSubmitting: false,
                    submitResult: {
                        message: '',
                        type: ''
                    },
                    apiConfig: {
                        url: 'https://www.d-xilzd.com/otc/api/whiteList/commit',
                        token: ''
                    }
                };
            },
            methods: {
                async submitIp() {
                    if (!this.formData.ip) {
                        this.submitResult = {
                            message: '请输入IP地址',
                            type: 'error'
                        };
                        return;
                    }
                    
                    if (!this.isValidIpAddress(this.formData.ip)) {
                        this.submitResult = {
                            message: '请输入有效的IP地址格式',
                            type: 'error'
                        };
                        return;
                    }
                    
                    if (!this.apiConfig.url) {
                        this.submitResult = {
                            message: '请配置API提交地址',
                            type: 'error'
                        };
                        return;
                    }
                    
                    this.isSubmitting = true;
                    this.submitResult = { message: '', type: '' };
                    
                    try {
                        // 构建请求数据
                        const requestData = {
                            ip: this.formData.ip
                        };
                        
                        // 配置请求头
                        const config = {
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        };
                        
                        // 添加认证token（如果有）
                        if (this.apiConfig.token) {
                            config.headers.Authorization = `Bearer ${this.apiConfig.token}`;
                        }
                        
                        // 发送POST请求
                        const response = await axios.post(this.apiConfig.url, requestData, config);
                        var res = response.data;
                        console.error(response);
                        if(res.code == '200'){
                              
                            this.submitResult = {
                                message: 'IP地址提交成功！',
                                type: 'success'
                            };
                        
                        }else{
     
                            this.submitResult = {
                                message: res.msg,
                                type: 'error'
                            };
                        }
                  
                        
                        // 清空表单
                        this.formData.ip = '';
                        
                        console.log('提交成功:', response.data);
                    } catch (error) {
                        this.submitResult = {
                            message: error.response?.data?.message || '提交失败，请检查网络连接和API配置',
                            type: 'error'
                        };
                        console.error('提交失败:', error);
                    } finally {
                        this.isSubmitting = false;
                    }
                },
                
                isValidIpAddress(ip) {
                    // IPv4正则表达式
                    const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
                    
                    // IPv6正则表达式
                    const ipv6Regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;
                    
                    return ipv4Regex.test(ip) || ipv6Regex.test(ip);
                }
            }
        });
    </script>
</body>
</html>
